function keyCodes(){this.tab=9;this.enter=13;this.esc=27;this.space=32;this.pageup=33;this.pagedown=34;this.end=35;this.home=36;this.left=37;this.up=38;this.right=39;this.down=40}function tpanelacc(n,t){this.settings=$.extend({},defaults,t);this.panel_id=n;this.accordianView=this.settings.accordian;this.$panel=$(n);this.accordian=this.settings.multiselectable;this.keys=new keyCodes;this.$panels=this.$panel.find("."+this.settings.panelClass);this.accordianFirstOpen=this.accordianView?this.settings.accordianFirstOpen:!0;this.createLayout();this.$tabs=this.$panel.find("."+this.settings.tabClass);this.bindHandlers();this._init();counter++}(function(n,t){"use strict";typeof define=="function"&&define.amd?define(["jquery"],function(i){t(n,i)}):typeof module=="object"&&module.exports?module.exports=t(n,require("jquery")):n.jQueryBridget=t(n,n.jQuery)})(window,function(n,t){"use strict";function u(i,u,o){function s(n,t,u){var f,e="$()."+i+'("'+t+'")';return n.each(function(n,s){var h=o.data(s,i),c,l;if(!h){r(i+" not initialized. Cannot call methods, i.e. "+e);return}if(c=h[t],!c||t.charAt(0)=="_"){r(e+" is not a valid method");return}l=c.apply(h,u);f=f===undefined?l:f}),f!==undefined?f:n}function h(n,t){n.each(function(n,r){var f=o.data(r,i);f?(f.option(t),f._init()):(f=new u(r,t),o.data(r,i,f))})}(o=o||t||n.jQuery,o)&&(u.prototype.option||(u.prototype.option=function(n){o.isPlainObject(n)&&(this.options=o.extend(!0,this.options,n))}),o.fn[i]=function(n){if(typeof n=="string"){var t=e.call(arguments,1);return s(this,n,t)}return h(this,n),this},f(o))}function f(n){!n||n&&n.bridget||(n.bridget=u)}var e=Array.prototype.slice,i=n.console,r=typeof i=="undefined"?function(){}:function(n){i.error(n)};return f(t||n.jQuery),u});var defaults={accordian:!1,multiselectable:!0,tabClass:"tab",panelClass:"panel",accordianIcon:!0,accordianImgIcon:{expanded:"expanded.gif",collapsed:"contracted.gif"},accordianImgAlt:{collapsed:"collapsed",expanded:"expanded"},accordianToggleElm:"h3",accordianFirstOpen:!0,accordianIconToEnd:!1},counter=0;tpanelacc.prototype.createLayout=function(){this.accordianView?this.accordianLayout():this.tpanelaccLayout()};tpanelacc.prototype.tpanelaccLayout=function(){var t=[],r=this.settings,u=this.accordianFirstOpen,n;if(this.$panels.each(function(n,i){$(i).attr({role:"tabpanel",id:"tp"+counter+"-panel"+n,"aria-labelledby":"tp"+counter+"-tab"+n}).css("display",u&&n==0?"block":"none");t[n]=$(i).data("tab-toggle")}),this.$panel.find(".tablist").length==0)for(n=this.$panel.find(".tablist"),this.$panel.prepend('<ul class="tablist" role="tablist"><\/ul>'),i=0;i<this.$panels.length;i++)n.append('<li id="tp'+counter+"-tab"+i+'" class="'+r.tabClass+'" aria-controls="tp'+counter+"-panel"+i+'" aria-selected="'+(i==0?"true":"false")+'" role="tab" tabindex="'+(i==0?"0":"-1")+'">'+t[i]+"<\/li>");else n=this.$panel.find(".tablist"),n.find("li").each(function(n,t){$(t).attr({role:"tab",id:"tp"+counter+"-tab"+n,"aria-labelledby":"tp"+counter+"-tab"+n,"aria-controls":"tp"+counter+"-panel"+n,"aria-selected":n==0?"true":"false",tabindex:n==0?"0":"-1"}).addClass(r.tabClass)})};tpanelacc.prototype.accordianLayout=function(){var n=this.settings,i=!0,t=this.accordianFirstOpen;this.$panel.has("."+this.settings.tabClass).length&&(i=!1);this.$panels.each(function(r,u){$(u).attr({role:"tabpanel",id:"tp"+counter+"-panel"+r,"aria-labelledby":"tp"+counter+"-tab"+r,"aria-hidden":t&&r==0?"false":"true"}).css("display",t&&r==0?"block":"none").addClass("accordian");var f='<i class="acc-toggle"><\/i>';n.accordianIcon&&(f='<i class="acc-toggle"><img class="toggle-img" src="'+(t&&r==0?n.accordianImgIcon.expanded:n.accordianImgIcon.collapsed)+'" alt="'+(t&&r==0?n.accordianImgAlt.expanded:n.accordianImgAlt.collapsed)+'" /><\/i>');i?($(u).closest(".panel-container").prepend("<"+n.accordianToggleElm+' id="tp'+counter+"-tab"+r+'" class="accordian '+n.tabClass+'" aria-controls="tp'+counter+"-panel"+r+'" aria-selected="'+(t&&r==0?"true":"false")+'" role="tab" tabindex="'+(r==0?"0":"-1")+'">'+$(u).data("tab-toggle")+"<\/"+n.accordianToggleElm+">"),n.accordianIconToEnd?$(u).closest(".panel-container").find(".accordian").append(f):$(u).closest(".panel-container").find(".accordian").prepend(f)):($(u).prev("."+n.tabClass).addClass("accordian").attr({id:"tp"+counter+"-tab"+r,"aria-controls":"tp"+counter+"-panel"+r,"aria-selected":t&&r==0?"true":"false",role:"tab",tabindex:r==0?"0":"-1"}),n.accordianIconToEnd?$("#tp"+counter+"-tab"+r).append(f):$("#tp"+counter+"-tab"+r).prepend(f),$("#tp"+counter+"-panel"+r+", #tp"+counter+"-tab"+r))});this.$panel.addClass("tablist").attr({role:"tablist",multiselectable:this.settings.multiselectable})};tpanelacc.prototype._init=tpanelacc.prototype.init=function(){var n;this.$panels.attr("aria-hidden","true");n=this.$tabs.filter('[aria-selected="true"]');n==undefined&&(n=this.$tabs.first());this.$panel.find("#"+n.attr("aria-controls")).attr({"aria-hidden":"false",tabindex:"0"})};tpanelacc.prototype.switchTabs=function(n,t){console.log("switchTabs");n.removeClass("focus");n.attr("tabindex","-1").attr("aria-selected","false");t.attr("aria-selected","true");this.accordianView&&this.accordian!=!1||(this.$panel.find("#"+n.attr("aria-controls")).attr({"aria-hidden":"true",tabindex:"-1"}).trigger("data-attribute-changed"),this.accordianView?this.$panel.find("#"+n.attr("aria-controls")).slideUp():this.$panel.find("#"+n.attr("aria-controls")).attr({"aria-hidden":"true",tabindex:"-1"}).hide(),n.attr("aria-expanded","false"),this.$panel.find("#"+t.attr("aria-controls")).attr({"aria-hidden":"false",tabindex:"0"}).triggerAll("data-attribute-changed data-visible-true"),this.accordianView?this.$panel.find("#"+t.attr("aria-controls")).slideDown():this.$panel.find("#"+t.attr("aria-controls")).attr({"aria-hidden":"false",tabindex:"0"}).show(),t.attr("aria-expanded","true"),this.accordianView==!0&&(this.$tabs.find("img").attr("src",this.settings.accordianImgIcon.collapsed).attr("alt",this.settings.accordianImgAlt.collapsed),t.find("img").attr("src",this.settings.accordianImgIcon.expanded).attr("alt",this.settings.accordianImgAlt.expanded)));t.attr("tabindex","0");t.focus()};tpanelacc.prototype.togglePanel=function(n){console.log("togglePanel");$panel=this.$panel.find("#"+n.attr("aria-controls"));this.accordian==!0&&this.accordianView==!0?$panel.attr("aria-hidden")=="true"?($panel.attr({"aria-hidden":"false",tabindex:"0"}).slideDown().triggerAll("data-attribute-changed data-visible-true"),n.find(".toggle-img").attr("src",this.settings.accordianImgIcon.expanded).attr("alt",this.settings.accordianImgAlt.expanded),n.attr("aria-expanded","true")):($panel.attr({"aria-hidden":"true",tabindex:"-1"}).slideUp().trigger("data-attribute-changed"),$panel.slideUp(100),n.find(".toggle-img").attr("src",this.settings.accordianImgIcon.collapsed).attr("alt",this.settings.accordianImgAlt.collapsed),n.attr("aria-expanded","false")):(this.$panels.attr({"aria-hidden":"true",tabindex:"-1"}).trigger("data-attribute-changed"),this.accordianView?this.$panels.not($panel).slideUp():this.$panels.not($panel).hide(),this.$tabs.attr("tabindex","-1").attr({"aria-selected":"false","aria-expanded":"false"}),n.attr({"aria-selected":"true","aria-expanded":"true"}),this.accordianView==!0&&(this.$tabs.find(".toggle-img").attr("src",this.settings.accordianImgIcon.collapsed).attr("alt",this.settings.accordianImgAlt.collapsed),n.find(".toggle-img").attr("src",this.settings.accordianImgIcon.expanded).attr("alt",this.settings.accordianImgAlt.expanded)),$panel.attr({"aria-hidden":"false",tabindex:"0"}).triggerAll("data-attribute-changed data-visible-true"),this.accordianView?$panel.slideDown():$panel.show(),n.attr("tabindex","0"),n.focus())};tpanelacc.prototype.bindHandlers=function(){var n=this;this.$tabs.keydown(function(t){return n.handleTabKeyDown($(this),t)});this.$tabs.keypress(function(t){return n.handleTabKeyPress($(this),t)});this.$tabs.click(function(t){return n.handleTabClick($(this),t)});this.$tabs.focus(function(t){return n.handleTabFocus($(this),t)});this.$tabs.blur(function(t){return n.handleTabBlur($(this),t)});this.$panels.keydown(function(t){return n.handlePanelKeyDown($(this),t)});this.$panels.keypress(function(t){return n.handlePanelKeyPress($(this),t)});this.$panels.click(function(t){return n.handlePanelClick($(this),t)})};tpanelacc.prototype.handleTabKeyDown=function(n,t){var u,r,i;if(t.altKey)return!0;switch(t.keyCode){case this.keys.enter:case this.keys.space:return this.accordian==!0?(this.togglePanel(n),t.stopPropagation(),!1):!0;case this.keys.left:case this.keys.up:return u=this,t.ctrlKey||(i=this.$tabs.index(n),r=i==0?this.$tabs.last():this.$tabs.eq(i-1),this.switchTabs(n,r)),t.stopPropagation(),!1;case this.keys.right:case this.keys.down:var u=this,r,i=this.$tabs.index(n);return r=i==this.$tabs.length-1?this.$tabs.first():this.$tabs.eq(i+1),this.switchTabs(n,r),t.stopPropagation(),!1;case this.keys.home:return this.switchTabs(n,this.$tabs.first()),t.stopPropagation(),!1;case this.keys.end:return this.switchTabs(n,this.$tabs.last()),t.stopPropagation(),!1}};tpanelacc.prototype.handleTabKeyPress=function(n,t){if(t.altKey)return!0;switch(t.keyCode){case this.keys.enter:case this.keys.space:case this.keys.left:case this.keys.up:case this.keys.right:case this.keys.down:case this.keys.home:case this.keys.end:return t.stopPropagation(),!1;case this.keys.pageup:case this.keys.pagedown:return t.ctrlKey?(t.stopPropagation(),!1):!0}return!0};tpanelacc.prototype.handleTabClick=function(n,t){return n.attr("tabindex","0").attr("aria-selected","true"),this.$tabs.not(n).attr("tabindex","-1").attr("aria-selected","false"),this.togglePanel(n),t.stopPropagation(),!1};tpanelacc.prototype.handleTabFocus=function(n){return n.addClass("focus"),!0};tpanelacc.prototype.handleTabBlur=function(n){return n.removeClass("focus"),!0};tpanelacc.prototype.handlePanelKeyDown=function(n,t){var s,l,u,h,a,o,f,r;if(t.altKey)return!0;switch(t.keyCode){case this.keys.tab:var i=n.find(":focusable"),r=i.index($(t.target)),e=this.$panels.index(n),c=this.$panels.length;if(t.shiftKey){if(r==0&&e>0)for(u=e-1;u>=0;u--)if(s=this.$panels.eq(u),l=$("#"+s.attr("aria-labelledby")),i.length=0,i=s.find(":focusable"),i.length>0)return i.last().focus(),this.$tabs.attr("aria-selected","false"),l.attr("aria-selected","true"),t.stopPropagation,!1}else if(e<c&&r==i.length-1)for(u=e+1;u<c;u++)if(h=this.$panels.eq(u),a=$("#"+h.attr("aria-labelledby")),i.length=0,i=h.find(":focusable"),i.length>0)return i.first().focus(),this.$tabs.attr("aria-selected","false"),a.attr("aria-selected","true"),t.stopPropagation,!1;break;case this.keys.left:case this.keys.up:return t.ctrlKey?(f=$("#"+n.attr("aria-labelledby")),f.focus(),t.stopPropagation(),!1):!0;case this.keys.pageup:return t.ctrlKey?(f=this.$tabs.filter('[aria-selected="true"]'),r=this.$tabs.index(f),o=r==0?this.$tabs.last():this.$tabs.eq(r-1),this.switchTabs(f,o),t.stopPropagation(),t.preventDefault(),!1):!0;case this.keys.pagedown:return t.ctrlKey?(f=$("#"+n.attr("aria-labelledby")),r=this.$tabs.index(f),o=r==this.$tabs.length-1?this.$tabs.first():this.$tabs.eq(r+1),this.switchTabs(f,o),t.stopPropagation(),t.preventDefault(),!1):!0}return!0};tpanelacc.prototype.handlePanelKeyPress=function(n,t){if(t.altKey)return!0;if(t.ctrlKey&&(t.keyCode==this.keys.pageup||t.keyCode==this.keys.pagedown))return t.stopPropagation(),t.preventDefault(),!1;switch(t.keyCode){case this.keys.esc:return t.stopPropagation(),t.preventDefault(),!1}return!0};tpanelacc.prototype.handlePanelClick=function(n){var t=$("#"+n.attr("aria-labelledby"));return t.attr("tabindex","0").attr("aria-selected","true"),this.$tabs.not(t).attr("tabindex","-1").attr("aria-selected","false"),!0};$.extend($.expr[":"],{focusable:function(n){var t=n.nodeName.toLowerCase(),i=$(n).attr("tabindex");return $(n)[t=="area"?"parents":"closest"](":hidden").length==!0?!1:!isNaN(i)&&i<0?!1:/input|select|textarea|button|object/.test(t)==!0?!n.disabled:(t=="a"||t=="area")==!0?n.href.length>0:!1}});$.fn.extend({triggerAll:function(n,t){for(var r=this,u=n.split(" "),i=0;i<u.length;i+=1)r.trigger(u[i],t);return r}});jQuery&&jQuery.bridget&&jQuery.bridget("tpanelacc",tpanelacc);
/*
//# sourceMappingURL=tpanelacc.min.js.map
*/
