function keyCodes(){this.tab=9,this.enter=13,this.esc=27,this.space=32,this.pageup=33,this.pagedown=34,this.end=35,this.home=36,this.left=37,this.up=38,this.right=39,this.down=40}function tpanelacc(t,e){this.settings=$.extend({},defaults,e),this.panel_id=t,this.accordianView=this.settings.accordian,this.$panel=$(t),this.accordian=this.settings.multiselectable,this.keys=new keyCodes,this.$panels=this.$panel.find("."+this.settings.panelClass),this.accordianFirstOpen=this.accordianView?this.settings.accordianFirstOpen:!0,this.createLayout(),this.$tabs=this.$panel.find("."+this.settings.tabClass),this.bindHandlers(),this.accordianToggleble=this.settings.accordianToggleble,this._init(),counter++}!function(t,e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],function(a){e(t,a)}):"object"==typeof module&&module.exports?module.exports=e(t,require("jquery")):t.jQueryBridget=e(t,t.jQuery)}(window,function(t,e){"use strict";function n(i,n,l){function c(t,e,a){var n,r="$()."+i+'("'+e+'")';return t.each(function(t,c){var o=l.data(c,i);if(!o)return void s(i+" not initialized. Cannot call methods, i.e. "+r);var d=o[e];if(!d||"_"==e.charAt(0))return void s(r+" is not a valid method");var h=d.apply(o,a);n=void 0===n?h:n}),void 0!==n?n:t}function o(t,e){t.each(function(t,a){var s=l.data(a,i);s?(s.option(e),s._init()):(s=new n(a,e),l.data(a,i,s))})}l=l||e||t.jQuery,l&&(n.prototype.option||(n.prototype.option=function(t){l.isPlainObject(t)&&(this.options=l.extend(!0,this.options,t))}),l.fn[i]=function(t){if("string"==typeof t){var e=a.call(arguments,1);return c(this,t,e)}return o(this,t),this},r(l))}function r(t){!t||t&&t.bridget||(t.bridget=n)}var a=Array.prototype.slice,i=t.console,s="undefined"==typeof i?function(){}:function(t){i.error(t)};return r(e||t.jQuery),n});var defaults={accordian:!1,multiselectable:!0,tabClass:"tab",panelClass:"panel",accordianIcon:!0,accordianImgIcon:{expanded:"expanded.gif",collapsed:"contracted.gif"},accordianImgAlt:{collapsed:"collapsed",expanded:"expanded"},accordianToggleElm:"h3",accordianFirstOpen:!0,accordianIconToEnd:!1,accordianToggleble:!1},counter=0;tpanelacc.prototype.createLayout=function(){this.accordianView?this.accordianLayout():this.tpanelaccLayout()},tpanelacc.prototype.tpanelaccLayout=function(){var t=[],e=this.settings,a=this.accordianFirstOpen;this.$panels.each(function(e,i){$(i).attr({role:"tabpanel",id:"tp"+counter+"-panel"+e,"aria-labelledby":"tp"+counter+"-tab"+e}).css("display",a&&0==e?"block":"none"),t[e]=$(i).data("tab-toggle")});var s;if(0==this.$panel.find(".tablist").length)for(s=this.$panel.find(".tablist"),this.$panel.prepend('<ul class="tablist" role="tablist"></ul>'),i=0;i<this.$panels.length;i++)s.append('<li id="tp'+counter+"-tab"+i+'" class="'+e.tabClass+'" aria-controls="tp'+counter+"-panel"+i+'" aria-selected="'+(0==i?"true":"false")+'" role="tab" tabindex="'+(0==i?"0":"-1")+'">'+t[i]+"</li>");else s=this.$panel.find(".tablist"),s.find("li").each(function(t,a){$(a).attr({role:"tab",id:"tp"+counter+"-tab"+t,"aria-controls":"tp"+counter+"-panel"+t,"aria-selected":0==t?"true":"false",tabindex:0==t?"0":"-1"}).addClass(e.tabClass)})},tpanelacc.prototype.accordianLayout=function(){var t=this.settings,e=!0,a=this.accordianFirstOpen;this.$panel.has("."+this.settings.tabClass).length&&(e=!1),this.$panels.each(function(i,s){$(s).attr({role:"tabpanel",id:"tp"+counter+"-panel"+i,"aria-labelledby":"tp"+counter+"-tab"+i,"aria-hidden":a&&0==i?"false":"true"}).css("display",a&&0==i?"block":"none").addClass("accordian");var n='<i class="acc-toggle"></i>';t.accordianIcon&&(n='<i class="acc-toggle"><img class="toggle-img" src="'+(a&&0==i?t.accordianImgIcon.expanded:t.accordianImgIcon.collapsed)+'" alt="'+(a&&0==i?t.accordianImgAlt.expanded:t.accordianImgAlt.collapsed)+'" /></i>'),e?($(s).before("<"+t.accordianToggleElm+' id="tp'+counter+"-tab"+i+'" class="accordian '+t.tabClass+'" aria-controls="tp'+counter+"-panel"+i+'" aria-selected="'+(a&&0==i?"true":"false")+'" aria-expanded="'+(a&&0==i?"true":"false")+'" role="tab" tabindex="'+(0==i?"0":"-1")+'">'+$(s).data("tab-toggle")+"</"+t.accordianToggleElm+">"),t.accordianIconToEnd?$(s).prev(".accordian").append(n):$(s).prev(".accordian").prepend(n)):($(s).prev("."+t.tabClass).addClass("accordian").attr({id:"tp"+counter+"-tab"+i,"aria-controls":"tp"+counter+"-panel"+i,"aria-selected":a&&0==i?"true":"false","aria-expanded":a&&0==i?"true":"false",role:"tab",tabindex:0==i?"0":"-1"}),t.accordianIconToEnd?$("#tp"+counter+"-tab"+i).append(n):$("#tp"+counter+"-tab"+i).prepend(n),$("#tp"+counter+"-panel"+i+", #tp"+counter+"-tab"+i))}),this.$panel.addClass("tablist").attr({role:"tablist",multiselectable:this.settings.multiselectable})},tpanelacc.prototype._init=tpanelacc.prototype.init=function(){var t;this.$panels.attr("aria-hidden","true"),t=this.$tabs.filter('[aria-selected="true"]'),void 0==t&&(t=this.$tabs.first()),this.$panel.find("#"+t.attr("aria-controls")).attr({"aria-hidden":"false",tabindex:"0"})},tpanelacc.prototype.switchTabs=function(t,e){console.log("switchTabs"),t.removeClass("focus"),t.attr("tabindex","-1").attr("aria-selected","false"),e.attr("aria-selected","true"),this.accordianView&&0!=this.accordian||(this.$panel.find("#"+t.attr("aria-controls")).attr({"aria-hidden":"true",tabindex:"-1"}).trigger("data-attribute-changed"),this.accordianView?this.$panel.find("#"+t.attr("aria-controls")).slideUp():this.$panel.find("#"+t.attr("aria-controls")).attr({"aria-hidden":"true",tabindex:"-1"}).hide(),t.attr("aria-expanded","false"),this.$panel.find("#"+e.attr("aria-controls")).attr({"aria-hidden":"false",tabindex:"0"}).triggerAll("data-attribute-changed data-visible-true"),this.accordianView?this.$panel.find("#"+e.attr("aria-controls")).slideDown():this.$panel.find("#"+e.attr("aria-controls")).attr({"aria-hidden":"false",tabindex:"0"}).show(),e.attr("aria-expanded","true"),1==this.accordianView&&(this.$tabs.find("img").attr("src",this.settings.accordianImgIcon.collapsed).attr("alt",this.settings.accordianImgAlt.collapsed),e.find("img").attr("src",this.settings.accordianImgIcon.expanded).attr("alt",this.settings.accordianImgAlt.expanded))),e.attr("tabindex","0"),e.focus()},tpanelacc.prototype.togglePanel=function(t){console.log("togglePanel"),$panel=this.$panel.find("#"+t.attr("aria-controls")),1==this.accordian&&1==this.accordianView?"true"==$panel.attr("aria-hidden")?($panel.attr({"aria-hidden":"false",tabindex:"0"}).slideDown().triggerAll("data-attribute-changed data-visible-true"),t.find(".toggle-img").attr("src",this.settings.accordianImgIcon.expanded).attr("alt",this.settings.accordianImgAlt.expanded),t.attr("aria-expanded","true")):($panel.attr({"aria-hidden":"true",tabindex:"-1"}).slideUp().trigger("data-attribute-changed"),$panel.slideUp(100),t.find(".toggle-img").attr("src",this.settings.accordianImgIcon.collapsed).attr("alt",this.settings.accordianImgAlt.collapsed),t.attr("aria-expanded","false")):1==this.accordianToggleble&&"true"==t.attr("aria-expanded")?(this.$panels.attr({"aria-hidden":"true",tabindex:"-1"}).trigger("data-attribute-changed"),this.accordianView?this.$panels.slideUp():this.$panels.hide(),this.$tabs.attr("tabindex","-1").attr({"aria-selected":"false","aria-expanded":"false"}),this.$tabs.find(".toggle-img").attr("src",this.settings.accordianImgIcon.collapsed).attr("alt",this.settings.accordianImgAlt.collapsed),t.attr("tabindex","0"),t.attr({"aria-selected":"true"})):(this.$panels.attr({"aria-hidden":"true",tabindex:"-1"}).trigger("data-attribute-changed"),this.accordianView?this.$panels.not($panel).slideUp():this.$panels.not($panel).hide(),this.$tabs.attr("tabindex","-1").attr({"aria-selected":"false","aria-expanded":"false"}),t.attr({"aria-selected":"true","aria-expanded":"true"}),1==this.accordianView&&(this.$tabs.find(".toggle-img").attr("src",this.settings.accordianImgIcon.collapsed).attr("alt",this.settings.accordianImgAlt.collapsed),t.find(".toggle-img").attr("src",this.settings.accordianImgIcon.expanded).attr("alt",this.settings.accordianImgAlt.expanded)),$panel.attr({"aria-hidden":"false",tabindex:"0"}).triggerAll("data-attribute-changed data-visible-true"),this.accordianView?$panel.slideDown():$panel.show(),t.attr("tabindex","0"),t.focus())},tpanelacc.prototype.bindHandlers=function(){var t=this;this.$tabs.keydown(function(e){return t.handleTabKeyDown($(this),e)}),this.$tabs.keypress(function(e){return t.handleTabKeyPress($(this),e)}),this.$tabs.click(function(e){return t.handleTabClick($(this),e)}),this.$tabs.focus(function(e){return t.handleTabFocus($(this),e)}),this.$tabs.blur(function(e){return t.handleTabBlur($(this),e)}),this.$panels.keydown(function(e){return t.handlePanelKeyDown($(this),e)}),this.$panels.keypress(function(e){return t.handlePanelKeyPress($(this),e)}),this.$panels.click(function(e){return t.handlePanelClick($(this),e)})},tpanelacc.prototype.handleTabKeyDown=function(t,e){if(e.altKey)return!0;switch(e.keyCode){case this.keys.enter:case this.keys.space:return 1==this.accordian||this.accordianView&&this.accordianToggleble?(this.togglePanel(t),e.stopPropagation(),!1):!0;case this.keys.left:case this.keys.up:var s;if(e.ctrlKey);else{var n=this.$tabs.index(t);s=0==n?this.$tabs.last():this.$tabs.eq(n-1),this.switchTabs(t,s)}return e.stopPropagation(),!1;case this.keys.right:case this.keys.down:var s,n=this.$tabs.index(t);return s=n==this.$tabs.length-1?this.$tabs.first():this.$tabs.eq(n+1),this.switchTabs(t,s),e.stopPropagation(),!1;case this.keys.home:return this.switchTabs(t,this.$tabs.first()),e.stopPropagation(),!1;case this.keys.end:return this.switchTabs(t,this.$tabs.last()),e.stopPropagation(),!1}},tpanelacc.prototype.handleTabKeyPress=function(t,e){if(e.altKey)return!0;switch(e.keyCode){case this.keys.enter:case this.keys.space:case this.keys.left:case this.keys.up:case this.keys.right:case this.keys.down:case this.keys.home:case this.keys.end:return e.stopPropagation(),!1;case this.keys.pageup:case this.keys.pagedown:return e.ctrlKey?(e.stopPropagation(),!1):!0}return!0},tpanelacc.prototype.handleTabClick=function(t,e){return t.attr("tabindex","0").attr("aria-selected","true"),this.$tabs.not(t).attr("tabindex","-1").attr("aria-selected","false"),this.togglePanel(t),e.stopPropagation(),!1},tpanelacc.prototype.handleTabFocus=function(t){return t.addClass("focus"),!0},tpanelacc.prototype.handleTabBlur=function(t){return t.removeClass("focus"),!0},tpanelacc.prototype.handlePanelKeyDown=function(t,e){if(e.altKey)return!0;switch(e.keyCode){case this.keys.tab:var a=t.find(":focusable"),i=a.index($(e.target)),s=this.$panels.index(t),n=this.$panels.length;if(console.log("$focusable",a),e.shiftKey){if(0==i&&s>0)for(var r=s-1;r>=0;r--){var l=this.$panels.eq(r),c=$("#"+l.attr("aria-labelledby"));if(a.length=0,a=l.find(":focusable"),a.length>0)return a.last().focus(),this.$tabs.attr("aria-selected","false"),c.attr("aria-selected","true"),e.stopPropagation,!1}}else if(n>s&&i==a.length-1)for(var r=s+1;n>r;r++){var o=this.$panels.eq(r),d=$("#"+o.attr("aria-labelledby"));if(a.length=0,a=o.find(":focusable"),a.length>0)return a.first().focus(),this.$tabs.attr("aria-selected","false"),d.attr("aria-selected","true"),e.stopPropagation,!1}break;case this.keys.left:case this.keys.up:if(!e.ctrlKey)return!0;var h=$("#"+t.attr("aria-labelledby"));return h.focus(),e.stopPropagation(),!1;case this.keys.pageup:var p;if(!e.ctrlKey)return!0;var h=this.$tabs.filter('[aria-selected="true"]'),i=this.$tabs.index(h);return p=0==i?this.$tabs.last():this.$tabs.eq(i-1),this.switchTabs(h,p),e.stopPropagation(),e.preventDefault(),!1;case this.keys.pagedown:var p;if(!e.ctrlKey)return!0;var h=$("#"+t.attr("aria-labelledby")),i=this.$tabs.index(h);return p=i==this.$tabs.length-1?this.$tabs.first():this.$tabs.eq(i+1),this.switchTabs(h,p),e.stopPropagation(),e.preventDefault(),!1}return!0},tpanelacc.prototype.handlePanelKeyPress=function(t,e){if(e.altKey)return!0;if(e.ctrlKey&&(e.keyCode==this.keys.pageup||e.keyCode==this.keys.pagedown))return e.stopPropagation(),e.preventDefault(),!1;switch(e.keyCode){case this.keys.esc:return e.stopPropagation(),e.preventDefault(),!1}return!0},tpanelacc.prototype.handlePanelClick=function(t){var a=$("#"+t.attr("aria-labelledby"));return a.attr("tabindex","0").attr("aria-selected","true"),this.$tabs.not(a).attr("tabindex","-1").attr("aria-selected","false"),!0},$.fn.extend({triggerAll:function(t,e){var i,a=this,s=t.split(" ");for(i=0;i<s.length;i+=1)a.trigger(s[i],e);return a}}),jQuery&&jQuery.bridget&&jQuery.bridget("tpanelacc",tpanelacc),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){function a(t){for(var e=t.css("visibility");"inherit"===e;)t=t.parent(),e=t.css("visibility");return"hidden"!==e}t.ui=t.ui||{};t.ui.version="1.12.1";t.ui.focusable=function(e,i){var s,n,r,l,c,o=e.nodeName.toLowerCase();return"area"===o?(s=e.parentNode,n=s.name,e.href&&n&&"map"===s.nodeName.toLowerCase()?(r=t("img[usemap='#"+n+"']"),r.length>0&&r.is(":visible")):!1):(/^(input|select|textarea|button|object)$/.test(o)?(l=!e.disabled,l&&(c=t(e).closest("fieldset")[0],c&&(l=!c.disabled))):l="a"===o?e.href||i:i,l&&t(e).is(":visible")&&a(t(e)))},t.extend(t.expr[":"],{focusable:function(e){return t.ui.focusable(e,null!=t.attr(e,"tabindex"))}});t.ui.focusable});
